# XPathAi
–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è Chrome, —É–ø—Ä–æ—â–∞—é—â–µ–µ –ø–æ–∏—Å–∫ —É—Å—Ç–æ–π—á–∏–≤—ã—Ö XPath-–ª–æ–∫–∞—Ç–æ—Ä–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º AI-—Å–µ—Ä–≤–∏—Å–æ–≤.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **extension/**
  - `contentScript.js` ‚Äì —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –∏ –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü–µ
  - `background.js` ‚Äì —Ñ–æ–Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
  - `popup/*` ‚Äì –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
  - `options.*` ‚Äì —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
  - `prompts/` ‚Äì —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è AI

- **backend/** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ AI)
  - `main.py` ‚Äì FastAPI —Å–µ—Ä–≤–µ—Ä —Å llama.cpp
  - `main_ollama.py` ‚Äì FastAPI —Å–µ—Ä–≤–µ—Ä —Å Ollama
  - Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ

1. **–í—ã–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞**: –ü–æ –∫–ª–∏–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É ¬´üîç¬ª –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ä–µ–∂–∏–º –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
2. **–ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∏ –≤—ã–±–æ—Ä**: `contentScript.js` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–≤–µ–¥–µ–Ω–∏–µ –º—ã—à–∏ –∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã. –ü—Ä–∏ –∫–ª–∏–∫–µ —ç–ª–µ–º–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è.
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è XPath**: –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ `background.js` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ XPath-–ª–æ–∫–∞—Ç–æ—Ä–æ–≤:
   - –û—Å–Ω–æ–≤–Ω–æ–π XPath
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π XPath
4. **AI-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º AI-—Ä–µ–∂–∏–º–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ –≤–Ω–µ—à–Ω–∏–π AI-—Å–µ—Ä–≤–∏—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ XPath.
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É XPath –∏ –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å –∏—Ö –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
6. **–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö–ª–∏–∫ –ø–æ –ø–æ–ª—é XPath –∫–æ–ø–∏—Ä—É–µ—Ç –µ–≥–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–µ—Å—Ç–∞—Ö.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AI-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω–æ, –≥–µ–Ω–µ—Ä–∏—Ä—É—è –±–∞–∑–æ–≤—ã–µ XPath-–ª–æ–∫–∞—Ç–æ—Ä—ã. –î–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –¥–æ—Å—Ç—É–ø–Ω–æ –¥–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ AI-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω—ã–π backend (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–° Ollama:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ollama —Å https://ollama.ai/
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–æ–¥–µ–ª—å: `ollama pull qwen2.5:3b`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ backend:
   ```cmd
   cd backend
   start_backend_venv.cmd
   # –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ü–∏—é 2 (Ollama)
   ```
4. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —É–∫–∞–∂–∏—Ç–µ:
   - **API URL**: `http://localhost:8000/generate-xpath`
   - **Model Name**: `qwen2.5:3b`

**–° llama.cpp:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `cd backend && docker-compose up -d --build`
2. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —É–∫–∞–∂–∏—Ç–µ:
   - **API URL**: `http://localhost:8000/generate-xpath`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –í–Ω–µ—à–Ω–∏–π AI-—Å–µ—Ä–≤–∏—Å

1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (‚öôÔ∏è)
2. –£–∫–∞–∂–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã AI-—Å–µ—Ä–≤–∏—Å–∞:
   - **API URL**
   - **API –∫–ª—é—á**
   - **–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏**

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–æ—Å—å –Ω–∞ –º–æ–¥–µ–ª—è—Ö:
- THUDM/glm-4-9b-chat
- deepseek-ai/DeepSeek-R1-Distill-Qwen-7B
- Qwen/Qwen2.5-Coder-7B-Instruct

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ Google Chrome –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ ¬´–†–∞—Å—à–∏—Ä–µ–Ω–∏—è¬ª ‚Üí ¬´–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏¬ª (`chrome://extensions/`)
2. –í–∫–ª—é—á–∏—Ç–µ ¬´–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞¬ª –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
3. –ù–∞–∂–º–∏—Ç–µ ¬´–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ¬ª –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É `extension`
4. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–æ—è–≤–∏—Ç—Å—è –≤ –ø–∞–Ω–µ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É**, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ XPath-–ª–æ–∫–∞—Ç–æ—Ä
2. **–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è** XPathAi –≤ –ø–∞–Ω–µ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
3. **–ù–∞–∂–º–∏—Ç–µ ¬´üîç¬ª** –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ä–µ–∂–∏–º–∞ –≤—ã–±–æ—Ä–∞
4. **–ù–∞–≤–µ–¥–∏—Ç–µ –∫—É—Ä—Å–æ—Ä –Ω–∞ –Ω—É–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç** (–æ–Ω –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—Å—è) –∏ **–∫–ª–∏–∫–Ω–∏—Ç–µ** –¥–ª—è –≤—ã–±–æ—Ä–∞
5. **–ü–æ–ª—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
   - –û—Å–Ω–æ–≤–Ω–æ–π XPath –≤ –≤–µ—Ä—Ö–Ω–µ–º –ø–æ–ª–µ
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π XPath –≤ –Ω–∏–∂–Ω–µ–º –ø–æ–ª–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
6. **–ö–ª–∏–∫–Ω–∏—Ç–µ –ø–æ –ø–æ–ª—é XPath** –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
7. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
   - **ü¶Ñ –ü–æ–∏—Å–∫ –¥—É–±–ª–µ–π** ‚Äì –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç –∏—Ö
   - **ü§ñ** ‚Äì –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
   - **üîÑÔ∏è** ‚Äì –æ—á–∏—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

> **Backend Setup:** –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ backend (Ollama, llama.cpp, Docker) –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ñ–∞–π–ª–µ `BACKEND_SETUP.md`. –õ–æ–∫–∞–ª—å–Ω—ã–π backend –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–µ—à–Ω–∏—Ö API –∫–ª—é—á–µ–π.

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è ¬´–∫–∞–∫ –µ—Å—Ç—å¬ª. –í–Ω–æ—Å–∏—Ç–µ –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è –ø–æ —Å–≤–æ–µ–º—É —É—Å–º–æ—Ç—Ä–µ–Ω–∏—é.

## –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Popup     ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  Background  ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  ContentScript  ‚îÇ
‚îÇ   (UI)      ‚îÇ    ‚îÇ  (Service    ‚îÇ    ‚îÇ  (Web Page)     ‚îÇ
‚îÇ             ‚îÇ    ‚îÇ   Worker)    ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                   ‚îÇ                     ‚îÇ
       ‚ñº                   ‚ñº                     ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Chrome    ‚îÇ    ‚îÇ  AI Service  ‚îÇ    ‚îÇ    DOM Tree     ‚îÇ
‚îÇ   Storage   ‚îÇ    ‚îÇ   (External) ‚îÇ    ‚îÇ   (Website)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

#### 1. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
```
Popup ‚îÄ‚îÄ action: "initSelection" ‚îÄ‚îÄ‚ñ∫ Background ‚îÄ‚îÄ action: "activateSelection" ‚îÄ‚îÄ‚ñ∫ ContentScript
  ‚îÇ                                                                                 ‚îÇ
  ‚îî‚îÄ‚îÄ tabId, useAI                                                                  ‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º –≤—ã–±–æ—Ä–∞
```

#### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XPath
```
ContentScript ‚îÄ‚îÄ action: "generateXPath" ‚îÄ‚îÄ‚ñ∫ Background ‚îÄ‚îÄ‚ñ∫ AI Service (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
     ‚îÇ                                        ‚îÇ                ‚îÇ
     ‚îî‚îÄ‚îÄ DOM, element data, useAI             ‚îÇ                ‚îî‚îÄ‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XPath
                                              ‚ñº
                                        Chrome Storage ‚óÑ‚îÄ‚îÄ‚îÄ –†–µ–∑—É–ª—å—Ç–∞—Ç
                                              ‚îÇ
                                              ‚ñº
                                            Popup ‚óÑ‚îÄ‚îÄ‚îÄ storage.onChanged
                                              ‚îÇ
                                              ‚îî‚îÄ‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
```

#### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
```
Popup ‚îÄ‚îÄ action: "checkXpathUniqueness" ‚îÄ‚îÄ‚ñ∫ ContentScript
  ‚îÇ                                           ‚îÇ
  ‚îî‚îÄ‚îÄ xpath                                   ‚îî‚îÄ‚îÄ –ü–æ–¥—Å—á–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                                              ‚îÇ
                                              ‚ñº
                                        Chrome Storage ‚óÑ‚îÄ‚îÄ‚îÄ duplicates count
                                              ‚îÇ
                                              ‚ñº
                                            Popup ‚óÑ‚îÄ‚îÄ‚îÄ storage.onChanged
```

#### 4. –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
```
Popup ‚îÄ‚îÄ action: "highlightDuplicates" ‚îÄ‚îÄ‚ñ∫ ContentScript
  ‚îÇ                                         ‚îÇ
  ‚îî‚îÄ‚îÄ xpath                                 ‚îî‚îÄ‚îÄ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
```

### –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π

| –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å | –ü–æ–ª—É—á–∞—Ç–µ–ª—å | –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------------|------------|---------------|------------|
| Popup | Background | `action: "initSelection"` | –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ä–µ–∂–∏–º–∞ –≤—ã–±–æ—Ä–∞ |
| Background | ContentScript | `action: "activateSelection"` | –ó–∞–ø—É—Å–∫ –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ |
| ContentScript | Background | `action: "generateXPath"` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XPath |
| Popup | ContentScript | `action: "checkXpathUniqueness"` | –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ |
| Popup | ContentScript | `action: "highlightDuplicates"` | –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ |

### –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

**Chrome Storage (local):**
- `status` - —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–∏
- `xpath` - –æ—Å–Ω–æ–≤–Ω–æ–π XPath
- `alternativeXpath` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π XPath  
- `explanation` - –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (AI)
- `error` - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- `duplicates` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- `isAIEnabled` - —Å–æ—Å—Ç–æ—è–Ω–∏–µ AI-—Ä–µ–∂–∏–º–∞
- `apiServiceUrl` - URL AI —Å–µ—Ä–≤–∏—Å–∞
- `apiKey` - –∫–ª—é—á API ‚ö†Ô∏è
- `modelName` - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
- `defaultPromptTemplate` - —à–∞–±–ª–æ–Ω –ø—Ä–æ–º–ø—Ç–∞

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: API –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏ –∏–ª–∏ –∫–ª—é—á–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–∏ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –∫—Ä–∏—Ç–∏—á–Ω—ã–º –¥–∞–Ω–Ω—ã–º.
